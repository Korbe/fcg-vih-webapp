{"version":3,"file":"PostAudioPlayer-Cx6e1iNv.js","sources":["../../../node_modules/@heroicons/vue/24/outline/esm/BackwardIcon.js","../../../node_modules/@heroicons/vue/24/outline/esm/CheckBadgeIcon.js","../../../node_modules/@heroicons/vue/24/solid/esm/PauseIcon.js","../../../node_modules/@heroicons/vue/24/solid/esm/PlayIcon.js","../../../resources/js/Shared/HashIt.js","../../../resources/js/Partials/PostAudioPlayer.vue"],"sourcesContent":["import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nexport default function render(_ctx, _cache) {\n  return (_openBlock(), _createElementBlock(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    \"stroke-width\": \"1.5\",\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\"\n  }, [\n    _createElementVNode(\"path\", {\n      \"stroke-linecap\": \"round\",\n      \"stroke-linejoin\": \"round\",\n      d: \"M21 16.811c0 .864-.933 1.406-1.683.977l-7.108-4.061a1.125 1.125 0 0 1 0-1.954l7.108-4.061A1.125 1.125 0 0 1 21 8.689v8.122ZM11.25 16.811c0 .864-.933 1.406-1.683.977l-7.108-4.061a1.125 1.125 0 0 1 0-1.954l7.108-4.061a1.125 1.125 0 0 1 1.683.977v8.122Z\"\n    })\n  ]))\n}","import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nexport default function render(_ctx, _cache) {\n  return (_openBlock(), _createElementBlock(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    \"stroke-width\": \"1.5\",\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\"\n  }, [\n    _createElementVNode(\"path\", {\n      \"stroke-linecap\": \"round\",\n      \"stroke-linejoin\": \"round\",\n      d: \"M9 12.75 11.25 15 15 9.75M21 12c0 1.268-.63 2.39-1.593 3.068a3.745 3.745 0 0 1-1.043 3.296 3.745 3.745 0 0 1-3.296 1.043A3.745 3.745 0 0 1 12 21c-1.268 0-2.39-.63-3.068-1.593a3.746 3.746 0 0 1-3.296-1.043 3.745 3.745 0 0 1-1.043-3.296A3.745 3.745 0 0 1 3 12c0-1.268.63-2.39 1.593-3.068a3.745 3.745 0 0 1 1.043-3.296 3.746 3.746 0 0 1 3.296-1.043A3.746 3.746 0 0 1 12 3c1.268 0 2.39.63 3.068 1.593a3.746 3.746 0 0 1 3.296 1.043 3.746 3.746 0 0 1 1.043 3.296A3.745 3.745 0 0 1 21 12Z\"\n    })\n  ]))\n}","import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nexport default function render(_ctx, _cache) {\n  return (_openBlock(), _createElementBlock(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    viewBox: \"0 0 24 24\",\n    fill: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\"\n  }, [\n    _createElementVNode(\"path\", {\n      \"fill-rule\": \"evenodd\",\n      d: \"M6.75 5.25a.75.75 0 0 1 .75-.75H9a.75.75 0 0 1 .75.75v13.5a.75.75 0 0 1-.75.75H7.5a.75.75 0 0 1-.75-.75V5.25Zm7.5 0A.75.75 0 0 1 15 4.5h1.5a.75.75 0 0 1 .75.75v13.5a.75.75 0 0 1-.75.75H15a.75.75 0 0 1-.75-.75V5.25Z\",\n      \"clip-rule\": \"evenodd\"\n    })\n  ]))\n}","import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nexport default function render(_ctx, _cache) {\n  return (_openBlock(), _createElementBlock(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    viewBox: \"0 0 24 24\",\n    fill: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\"\n  }, [\n    _createElementVNode(\"path\", {\n      \"fill-rule\": \"evenodd\",\n      d: \"M4.5 5.653c0-1.427 1.529-2.33 2.779-1.643l11.54 6.347c1.295.712 1.295 2.573 0 3.286L7.28 19.99c-1.25.687-2.779-.217-2.779-1.643V5.653Z\",\n      \"clip-rule\": \"evenodd\"\n    })\n  ]))\n}","/**\n * Returns a hash code from a string\n * @param  {String} str The string to hash.\n * @return {Number}    A 32bit integer\n * @see http://werxltd.com/wp/2010/05/13/javascript-implementation-of-javas-string-hashcode-method/\n */\nexport const hashIt = (str) => {\n    let hash = 0;\n    for (let i = 0, len = str.length; i < len; i++) {\n        let chr = str.charCodeAt(i);\n        hash = (hash << 5) - hash + chr;\n        hash |= 0; // Convert to 32bit integer\n    }\n    return hash;\n}","<template>\n    <div ref=\"wrapper\"\n        class=\"relative flex flex-col sm:flex-row text-center rounded-lg border border-gray-300 bg-white px-2 md:px-6 py-5  items-center justify-center\n        md:text-left md:justify-between\n        shadow-sm hover:border-brand-primary focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-brand-primary\">\n\n        <div ref=\"progressBox\"  class=\"rounded-l-lg h-full absolute w-0 inset-0 bg-brand-primary-100\"></div>\n\n        <div class=\"z-10 pb-3 md:pb-0 flex-shrink-0\">\n            <img loading=\"lazy\" :alt=\"post.author\" :src=\"post.author_image\" class=\"relative rounded-full h-16 w-16\" />\n        </div>\n\n        <div class=\"z-10 basis-full w-full md:pl-4\">\n\n            <p v-if=\"completed\" class=\"text-brand-primary flex\">\n                <CheckBadgeIcon class=\"h-7 mr-1\"/>\n                <span class=\"inline-block\">{{'Angehört'}}</span>\n            </p>\n\n            <p class=\"text-xl md:text-2xl font-medium text-gray-900\">\n                {{ post.title }}\n            </p>\n            <p class=\"py-3 text-base text-gray-500\">\n                <span class=\"font-medium hover:underline\">{{ post.author }}</span>\n                <span class=\"text-gray-600\"> · {{ post.published_at }}</span>\n            </p>\n        </div>\n\n        <div v-if=\"post.audio && audioRef\" class=\"z-10 w-full sm:flex flex-end md:justify-end sm:justify-center\">\n            <div class=\"flex space-x-2\">\n\n                <a v-if=\"audioRef.currentTime > 0\"\n                   class=\"p-2 flex items-center justify-center  border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-brand-primary hover:bg-brand-secondary-400\"\n                   href=\"#\"\n                   @click.prevent=\"addSeconds(-10)\">\n                    <BackwardIcon class=\"h-7 mr-1\"/>\n                    10s\n                </a>\n\n                <a :id=\"'play_button_' + index\" class=\"p-2 flex items-center justify-center w-full  border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-brand-primary hover:bg-brand-secondary-400\"\n                   href=\"#\"\n                   @click.prevent=\"playPause()\">\n                    <template v-if=\"audioRef.paused\">\n                        <PlayIcon class=\"h-7 mr-1\"/>\n                        <span class=\"inline-block\">{{songTime ?? 'Abspielen'}}</span>\n                    </template>\n                    <template v-else>\n                        <PauseIcon class=\"h-7 mr-1\"/>\n                        <span class=\"inline-block\">{{songTime ?? 'Pause'}}</span>\n                    </template>\n                </a>\n\n                <a v-if=\"audioRef.currentTime > 0\"\n                   class=\"p-2 flex items-center justify-center border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-brand-primary hover:bg-brand-secondary-400\"\n                   href=\"#\"\n                   @click.prevent=\"addSeconds(60)\">\n                    1min\n                    <BackwardIcon class=\"rotate-180 h-7 ml-1\"/>\n                </a>\n\n            </div>\n        </div>\n\n        <audio :id=\"audio_id\" ref=\"audioRef\" @timeupdate=\"onTimeUpdate\" @ended=\"onEnded\">\n                <source :src=\"post.audio\" type=\"audio/mp3\"/> Your browser does not support the audio tag.\n        </audio>\n    </div>\n</template>\n<script setup>\nimport { ref, onMounted, computed } from 'vue';\nimport { PauseIcon, PlayIcon } from \"@heroicons/vue/24/solid\";\nimport { BackwardIcon, CheckBadgeIcon } from \"@heroicons/vue/24/outline\";\nimport { hashIt } from \"@/Shared/HashIt\";\nimport { router } from '@inertiajs/vue3';\n\nconst props = defineProps({\n    post: Object,\n    index: Number\n});\n\n// Reaktive Variablen\nconst audioRef = ref(null);\nconst songTime = ref(null);\nconst completed = ref(false);\nconst viewStatRecorded = ref(false);\nconst wrapper = ref(null);\nconst progressBox = ref(null);\nconst audio_id = computed(() => `audio_${props.index}`);\n\nonMounted(() => {\n    audioRef.value = document.getElementById(audio_id.value);\n\n    let completedHistory = JSON.parse(localStorage.getItem(\"completion-hist\")) ?? [];\n    if (completedHistory.includes(getHash())) {\n        completed.value = true;\n    }\n});\n\nconst songActive = () => {\n    // Event kann hier bei Bedarf emittiert werden\n};\n\nconst addSeconds = (sec) => {\n    if (audioRef.value) {\n        audioRef.value.currentTime += sec;\n    }\n};\n\nconst playPause = () => {\n    if (audioRef.value.paused) {\n        songActive();\n        completed.value = false;\n        audioRef.value.play();\n        SetPostViewed();\n    } else {\n        audioRef.value.pause();\n    }\n};\n\nconst onTimeUpdate = () => {\n    if (!audioRef.value) return;\n\n    let { currentTime, duration } = audioRef.value;\n\n    let currentSeconds = (Math.floor(currentTime % 60) < 10 ? '0' : '') + Math.floor(currentTime % 60);\n    let currentMinutes = Math.floor(currentTime / 60);\n    songTime.value = `${currentMinutes}:${currentSeconds} / ${Math.floor(duration / 60)}:${Math.floor(duration % 60).toString().padStart(2, '0')}`;\n\n    let percentageOfSong = (currentTime / duration);\n    progressBox.value.style.width = `${Math.round(wrapper.value.offsetWidth * percentageOfSong)}px`;\n};\n\nconst getHash = () => {\n    return hashIt(`${props.post.author}.${props.post.title}`);\n};\n\nconst onEnded = () => {\n    if (audioRef.value) {\n        audioRef.value.pause();\n        audioRef.value.currentTime = 0;\n        completed.value = true;\n\n        if (progressBox.value) {\n            progressBox.value.style.width = \"0px\";\n        }\n\n        SetPostCompleted();\n\n        let completedHistory = JSON.parse(localStorage.getItem(\"completion-hist\")) ?? [];\n        if (!completedHistory.includes(getHash())) {\n            localStorage.setItem(\"completion-hist\", JSON.stringify([...completedHistory, getHash()]));\n        }\n    }\n};\n\nconst SetPostViewed = () => {\n    if (!viewStatRecorded.value) {\n        router.post(route('public.blog.post.viewed', props.post.id), null, { preserveScroll: true });\n        viewStatRecorded.value = true;\n    }\n};\n\nconst SetPostCompleted = () => {\n    router.post(route('public.blog.post.completed', props.post.id), null, { preserveScroll: true });\n};\n</script>"],"names":["render","_ctx","_cache","_openBlock","_createElementBlock","_createElementVNode","hashIt","str","hash","i","len","chr","props","__props","audioRef","ref","songTime","completed","viewStatRecorded","wrapper","progressBox","audio_id","computed","onMounted","getHash","addSeconds","sec","playPause","SetPostViewed","onTimeUpdate","currentTime","duration","currentSeconds","currentMinutes","percentageOfSong","onEnded","SetPostCompleted","completedHistory","router"],"mappings":"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","x_google_ignoreList":[0,1,2,3]}